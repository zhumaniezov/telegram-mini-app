<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title data-i18n="vacationTitlePage">üèñÔ∏è –í–∞—à –æ—Ç–ø—É—Å–∫</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <link rel="stylesheet" href="style.css" />
</head>
<body class="info-screen">
<!-- –§–ª—ç—Ç-–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" —Å SVG-–∏–∫–æ–Ω–∫–æ–π, —Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É -->
  <div class="toolbar">
    <button class="back-btn" onclick="universalBack()" aria-label="–ù–∞–∑–∞–¥">
      <svg viewBox="0 0 24 24" width="28" height="28" fill="none" stroke="#bfc8e2" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M16 4l-8 8 8 8"/>
      </svg>
    </button>
    <span class="toolbar-title" data-i18n="salaryTitle">üí∞ –ó–∞—Ä–ø–ª–∞—Ç–∞</span>
  </div>
  <div class="container">
    <h1 data-i18n="vacationTitlePage">üèñÔ∏è –í–∞—à –æ—Ç–ø—É—Å–∫</h1>

    <div class="info-card">
      <div class="vacation-balance">
        <p><span data-i18n="daysLeft"></span> <strong id="days-left">14</strong></p>
        <div class="progress-bar">
          <div class="progress-fill" style="width: 70%"></div>
        </div>
      </div>
      
      <div class="date-selection">
        <h3 data-i18n="planVacation"></h3>
        <input type="text" id="dateRange" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã" readonly />
        <button id="submitVacation" class="submit-btn" data-i18n="submitRequest"></button>
      </div>
      
      <div class="upcoming-vacation">
        <h3 data-i18n="upcomingVacation"></h3>
        <p id="next-vacation">1-15 –∞–≤–≥—É—Å—Ç–∞ (14 –¥–Ω–µ–π)</p>
      </div>
    </div>
  </div>

  <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" -->
  <div class="fixed-back-btn">
    <button onclick="window.location.href='main.html'" class="back-btn" data-i18n="back"></button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ru.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/uz.js"></script>
  <script src="lang.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      translatePage();

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∞ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
      const container = document.querySelector('.container');
      const backBtn = document.querySelector('.fixed-back-btn');
      let lastScroll = 0;

      if (container && backBtn) {
        container.addEventListener('scroll', () => {
          const currentScroll = container.scrollTop;
          if (currentScroll > lastScroll) {
            backBtn.classList.add('hide-back-btn');
          } else {
            backBtn.classList.remove('hide-back-btn');
          }
          lastScroll = currentScroll;
        });
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è
      flatpickr("#dateRange", {
        mode: "range",
        dateFormat: "d.m.Y",
        locale: currentLang === 'uz' ? 'uz' : 'ru',
        minDate: "today",
        maxDate: new Date().fp_incr(365),
        onChange: function(selectedDates) {
          if (selectedDates.length === 2) {
            const diff = Math.ceil((selectedDates[1] - selectedDates[0]) / (1000 * 60 * 60 * 24)) + 1;
            document.getElementById('days-left').textContent = 14 - diff;
          }
        }
      });

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
      document.getElementById('submitVacation').addEventListener('click', function() {
        const dates = document.getElementById('dateRange').value;
        if (dates) {
          const [start, end] = dates.split(' to ');
          const days = Math.ceil((new Date(end) - new Date(start)) / (1000 * 60 * 60 * 24)) + 1;
          
          alert(currentLang === 'uz' 
            ? `Ta'til so‚Äòrovi yuborildi: ${start} - ${end}` 
            : `–ó–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ç–ø—É—Å–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: ${start} - ${end}`);
          
          document.getElementById('next-vacation').textContent = 
            `${start} - ${end} (${days} ${currentLang === 'uz' ? 'kun' : '–¥–Ω–µ–π'})`;
        } else {
          alert(currentLang === 'uz' 
            ? 'Iltimos, sanalarni tanlang' 
            : '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—ã –æ—Ç–ø—É—Å–∫–∞');
        }
      });
    });
  </script>
<script>
    function universalBack() {
      if (window.history.length > 1) {
        window.history.back();
      } else {
        window.location.href = "main.html";
      }
    }
  </script>
</body>
</html>
